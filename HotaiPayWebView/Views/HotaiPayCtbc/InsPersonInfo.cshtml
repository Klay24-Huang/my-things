@model HotaiPayWebView.Models.TangViewModel

@{
    ViewBag.Title = "InsPersonInfo";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>輸入個人資料</title>

    <link rel="stylesheet" href="~/Content/HotaiPayCss/bootstrap.css">
    <link rel="stylesheet" href="~/Content/HotaiPayCss/style.css">
    <script src="~/Scripts/HotaiPayJS/PostAndGoto.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="js/main.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
</head>

<body>


    <header class="d-flex justify-content-center align-items-center"><h6 style="margin-top: 8px;">輸入個人資料</h6></header>
    @using (Html.BeginForm("InsPersonInfo", "HotaiPayCtbc", FormMethod.Post, new { @id = "FastAddCardForm", @class = "form-horizontal", enctype = "multipart/form-data" }))
    {
        <div class="container" style="max-width: 414px;position:relative">
            <div class="mt-4">
                <p class="text-gray">輸入個人資料後，將透過簡訊驗證向中國信託取得您的中信卡資訊，確保支付安全。</p>
            </div>

            <div class="mt-4">
                <label>生日</label>
                @*<input type="text" class="form-control input-light" placeholder="輸入生日 ex.19950101" name="BIRTHDATE" id="BIRTHDATE" required>*@
                @Html.TextBoxFor(m => m.Birthday, new { @class = "form-control input-light", placeholder = "輸入生日 ex.19950101" })
            </div>

            <div class="mt-4">

                <label>身分證字號</label>
                @*<input type="text" class="form-control input-light" placeholder="輸入身分證字號" name="ID" id="ID" required>*@
                @Html.TextBoxFor(m => m.CTBCIDNO, new { @class = "form-control input-light", placeholder = "輸入身分證字號" })
            </div>

        </div>

        <div class="footer-btn-box footer-btn-margin">
            <div class="buttonBox">
                <button type="submit" class="btn btn-blue bottom-btn mb-2" style="max-width:414px" onclick="FastAddCard()">
                    快速新增中信卡
                </button>
            </div>
        </div>
    }



</body>
</html>

<script type="text/javascript">

    var msg = '@(ViewData["ERROR"] == null ? "" : ViewData["ERROR"].ToString())';
    if (msg == 'ERROR') {
        swal("錯誤!", "請確認!", "error");
    }

    function FastAddCard() {
        console.log('2QQQ');
        //alert("Fast");
            $.ajax({
                type: "POST",
                url:"@Url.Action("InsPersonInfo")",
                data: $("#FastAddCardForm").serialize(),
                success: function (result) {
                    console.log('AAA');
                    if (result.succ) {
                        console.log('VVV');
                        GOTO("toCTBCFastSmall", result.gotoUrl, result.postData);//gotoUrl是去中信的網址/creditcard/fbinding
                    }
                    else {
                        swal("錯誤2!", "請確認!", "error");
                    }
                },
                error: function () {
                    //controller那就回傳錯誤訊息給view了，不在這做
                }
            })

            return false;
        }
</script>