@{
    Layout = null;
    string Processor = "";
    if (string.IsNullOrEmpty(User.Identity.Name) == false)
    {
        // WebModel.UserAccount uAccount = ViewData["loginUser"] as WebModel.UserAccount;
        Processor = User.Identity.Name;
    }
    int nowHandleTab = (ViewData["nowHandleTab"] == null) ? 0 : Convert.ToInt32(ViewData["nowHandleTab"]);
    string isSelect1 = "";
    string isSelect2 = "";
    if (nowHandleTab > 0)
    {

        isSelect1 = (nowHandleTab == 1) ? " drawer-open" : " drawer-close";
        isSelect2 = (nowHandleTab == 2) ? " drawer-open" : " drawer-close";
    }

}
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <link rel="shortcut icon" href="~/assets/img/favicon.ico" />
    <meta charset="utf-8">
    <title>iRent無人化租車共享系統</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Styles -->
    <link href="~/Content/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,400,600,300' rel='stylesheet' type='text/css'>
    <link href="~/Content/css/RealTimeMonitor.css" rel="stylesheet" type="text/css">
    <link href="~/Content/css/cabinet.css" rel="stylesheet" type="text/css" id="theme-style">
    <link href="~/Content/css/sweetalert.css" rel="stylesheet">
    <!-- JavaScript/jQuery, Pre-DOM -->
    <script src="~/Scripts/js/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDk869ONTbT88W_HJpJtw37Dxmzmgv5AHE&libraries=drawing"></script>
    <script src="~/Scripts/js/sweetalert.js"></script>
    @*<script src="~/Scripts/jquery.blockUI.2.6.1.js"></script>
    <script src="~/Scripts/custom.js"></script>*@
    <!-- HTML5, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
        <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</head>

<body>
    @using (Html.BeginForm("RealTimeMonitor", "Monitor", FormMethod.Get, new { id = "formRealTimeMonitor" }))
    {
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">事件處理</h4>
                    </div>
                    <div class="modal-body">
                        <form role="form">
                            <div class="form-group">
                                <label for="recipient-name" class="control-label">處理人員</label>
                                <input type="text" class="form-control" id="Processor" value="@Processor" readonly>
                            </div>
                            <div class="form-group">
                                <label for="message-text" class="control-label">處理說明</label>
                                <textarea class="form-control" id="HandleDescript" rows="5"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal" id="btnCancel" name="btnCancel">取消</button>
                        <button type="button" class="btn btn-danger" id="btnHandle" name="btnHandle">處理</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map -->
        <div class="iframe-container">
            <div class="gmaps" id="map"></div>
        </div>
        <!-- / Map -->
        <div class="cabinet-left">
            <div class="cabinet-drawer @isSelect1" id="T1">
                <div class="cabinet-knob">
                    <p>地圖監控</p>
                </div>
                @*@Html.Action("MapHandle", new { CarNo = "", SD = DateTime.Now.AddMinutes(-10), ED = DateTime.Now })*@
            </div>
            <div class="cabinet-drawer @isSelect2">
                <div class="cabinet-knob cabinet-knob2" id="T2">
                    <p>異常客服</p>
                </div>
                @*@Html.Action("EventHandle")*@
            </div>
        </div>
        <input type="hidden" name="MachineNo" id="MachineNo" />
        <input type="hidden" name="nowHandleTab" id="nowHandleTab" value="@nowHandleTab" />
    }
</body>

<!-- Javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
@*<script src="~/assets/js/bootstrap/bootstrap.min.js"></script>*@
<script type="text/javascript">
    var ts;
    var isFirst = true;
		var map_options = {
			center: new google.maps.LatLng(23.973875,120.982024),
			zoom: 18,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		}

		map_canvas = document.getElementById('map');
		var map = new google.maps.Map(map_canvas, map_options);


		$(".cabinet-knob").on("click", function(){
			var parent = $(this).parent(".cabinet-drawer");
			if($(this).parent(".drawer-open").css("left")<="0px"){
				parent.removeClass("drawer-open");
				parent.siblings().removeClass("drawer-close");
			}else{
				parent.addClass("drawer-open");
				parent.removeClass("drawer-close");
				parent.siblings().addClass("drawer-close");
				parent.siblings().removeClass("drawer-open");
				if ($(this).hasClass("cabinet-knob2")) {
                     $("#nowHandleTab").val(2);
				}else{
                    $("#nowHandleTab").val(1);
			    }
				console.log($(this).hasClass("cabinet-knob2"));
			}
		});


		$(".cabinet-box .open").on('click', function(){
			var _this= $(this).attr("rel");
			$('#' + _this).toggle();

			if($('#'+_this).css("display")=="none"){
				$(this).html("+");
			}else{
				$(this).html("-");
			}
		});


		$(".cabinet-box .info").on('click', function(){
			$(this).siblings().removeClass('active');
			$(this).addClass('active');
		});

		$(".cabinet-box .td").on('click', function(){
			var parent = $(this).parents(".cabinet-drawer");
			parent.removeClass("drawer-open");
			parent.siblings().removeClass("drawer-close");
		});

		$('#exampleModal').on('show.bs.modal', function (event) {
		  var button = $(event.relatedTarget) // Button that triggered the modal
		  var recipient = button.data('whatever') // Extract info from data-* attributes
		  var modal = $(this)
		  modal.find('.modal-title').text('處理事件：' + recipient)
		})
		function setMap(lat, lng,carNo) {
		    var myLatLng = { lat: lat, lng: lng };
		    var image = '../assets/img/icon_m_car.png';
		    var marker = new google.maps.Marker({
		        map: map,
		        position: myLatLng,
		        icon: image
		    });
		    var infowindow = new google.maps.InfoWindow();
		    infowindow.setContent('<b>' + carNo + '<b>');
		   // google.maps.event.addListener(marker, 'click', function () {
		        infowindow.open(map, marker);
		   // });
		    map.setCenter(marker.getPosition());
		}
		function moveCar(lat, lng, carNo) {
		    var myLatLng = { lat: lat, lng: lng };
		    var image = '../assets/img/icon_m_car.png';
		    var marker = new google.maps.Marker({
		        map: map,
		        position: myLatLng,
		        icon: image
		    });
		    var infowindow = new google.maps.InfoWindow();
		    infowindow.setContent('<b>' + carNo + '<b>');
		    // google.maps.event.addListener(marker, 'click', function () {
		    infowindow.open(map, marker);
		}
		function goHandle(MachineNo) {
		    console.log(MachineNo);
		    $("#MachineNo").val(MachineNo);
		    $("#nowHandleTab").val(2);
		    clearTimeout(ts);
		}
		$(function () {

		    calTime();

		    $("#btnCancel").on("click", function () { calTime(); });
		    $("#btnRefresh").on("click", function () { ToRefreash(); });
		    $("#btnHandle").on("click", function () {
		        var Processor = $("#Processor").val();
		        var HandleDescript = $("#HandleDescript").val();
		        var MachineNo = $("#MachineNo").val();
		        var flag = true;
		        var errMsg = "";
		        if (HandleDescript === "") {
		            flag = false;
		            errMsg = "處理說明未輸入";
		        }
		        if (flag) {
		            if (MachineNo === "") {
		                flag = false;
		                errMsg = "請重新整理網頁";
		            }
		        }
		        if (flag) {
		            if (Processor === "") {
		                flag = false;
		                errMsg = "請重新登入";
		            }
		        }
		        if (flag) {
		            //blockUI();
		            var checkData = new Object();
		            checkData.Processor = Processor;
		            checkData.HandleDescript = HandleDescript;
		            checkData.MachineNo = MachineNo;
		            console.log(checkData);
		            var sendData = new Object();
		            sendData.para = JSON.stringify(checkData);
		            console.log(sendData);
		            var jdata = JSON.stringify(sendData);
		            GetEncyptData(jdata, EventHandleComplete);
		        } else {
		            warningAlert(errMsg, false, 0, "");
		        }
		    });
		});
	function ToRefreash() {
	    var tab = $("#nowHandleTab").val();
	    console.log("tab=" + tab);
	    window.location.href = "?nowHandleTab=" + tab;
	}
	function timedRefresh() {
	    if (isFirst == false) {
	        ToRefreash();
	    } else {
	        isFirst = false;
	    }

        console.log("我有執行哦");
        ts=setTimeout(timedRefresh, 1000);
        // setInterval(getInfo, timeoutPeriod);
	}
	function calTime() {
	    var LastSecond = parseInt($("#LastSecond").val(),10);
	    if (LastSecond === 0) {
	        ToRefreash();
	    } else {
	        LastSecond = LastSecond - 1;
	        $("#LastSecond").val(LastSecond);
	        ts = setTimeout(calTime, 1000);
	    }
	}
</script>


<!-- Mirrored from lycaste.co/projects/avocadopanel/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 27 Jul 2016 07:40:43 GMT -->
</html>